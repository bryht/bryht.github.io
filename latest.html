<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Get the latest download version from GitHub</title>
</head>
<script>
    let url = document.URL;
    let para = url.split('?')[1];
    let user = para.split('/')[0];
    let repo = para.split('/')[1];
    let assetName = para.split('/')[2];
    let link = "https://github.com/" + user + "/" + repo + "/releases";
    var isIE = function () {
        var b = document.createElement('b')
        b.innerHTML = '<!--[if IE]><i></i><![endif]-->'
        return b.getElementsByTagName('i').length === 1
    }
    try {
        if (isIE()) {
            window.location.href = link;
        }
        fetch("https://api.github.com/repos/" + user + "/" + repo + "/releases/latest").then(res => res.json(), reject => {
            throw reject;
        }).then(result => {
            let assets = result.assets;
            if (assets.length > 0) {
                for (let index = 0; index < assets.length; index++) {
                    const element = assets[index];
                    if (element.name.indexOf(assetName) > 0 &&
                        (element.name.endsWith('.exe') ||
                            element.name.endsWith('.zip') ||
                            element.name.endsWith('.dmg'))) {
                        link = element.browser_download_url;
                    }
                }
                window.onload = function () { window.history.back(); }
                window.location.href = link;
            } else {
                throw Error('assets is null');
            }
        }).catch(reject => { throw reject });

    } catch (error) {
        window.location.href = link;
    }
</script>

<body>
</body>

</html>